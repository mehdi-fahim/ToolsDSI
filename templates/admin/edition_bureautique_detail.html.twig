{% extends 'admin/base.html.twig' %}

{% block title %}D√©tail √©dition bureautique - Panel Admin{% endblock %}

{% block content %}
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; flex-wrap: wrap; gap: 15px;">
        <div>
            <h2 style="color: #2d3748; font-size: 1.8rem; margin-bottom: 5px;">
                üìã {{ entity.NOM_DOCUMENT ?? entity.NOM_BI ?? 'D√©tail de l\'√©dition bureautique' }}
            </h2>
            <p style="color: #718096;">
                Code BI: {{ entity.NOM_BI }} ‚Ä¢ EditionBureautique
            </p>
        </div>
        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
            <a href="{{ path('admin_entity_view', {'entityName': 'EditionBureautique'}) }}" class="btn btn-secondary">‚Üê Retour √† la liste</a>
            <a href="{{ path('admin_dashboard') }}" class="btn btn-secondary">üè† Dashboard</a>
        </div>
    </div>

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px;">
        <!-- Informations g√©n√©rales -->
        <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
            <h3 style="color: #2d3748; margin-bottom: 20px; font-size: 1.3rem;">üìä Informations g√©n√©rales</h3>
            {% if metadata is defined and metadata.columns is defined %}
                {% for column in metadata.columns %}
                    <div style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #e2e8f0;">
                        <strong style="color: #4a5568; display: block; margin-bottom: 5px;">{{ column.label }}:</strong>
                        {% if entity[column.name] is defined %}
                            <span style="color: #2d3748;">{{ entity[column.name] }}</span>
                        {% else %}
                            <span style="color: #a0aec0;">-</span>
                        {% endif %}
                    </div>
                {% endfor %}
            {% else %}
                <div class="alert alert-warning">Aucune m√©tadonn√©e de colonne disponible.</div>
            {% endif %}
        </div>

        <!-- Description d√©taill√©e / Champs -->
        <div style="display: flex; flex-direction: column; gap: 24px;">
            <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
                {% if entity.DESCRIPTION_PLUS is defined and entity.DESCRIPTION_PLUS %}
                    <h3 style="color: #2d3748; margin-bottom: 20px; font-size: 1.3rem;">üìã Description d√©taill√©e</h3>
                    <div style="background: #f0fff4; padding: 20px; border-radius: 8px; border-left: 4px solid #38a169; margin-bottom: 10px;">
                        <p style="color: #2f855a; line-height: 1.6; margin: 0; white-space: pre-wrap;">{{ entity.DESCRIPTION_PLUS }}</p>
                    </div>
                {% else %}
                    <div class="alert alert-info">Aucune description d√©taill√©e disponible.</div>
                {% endif %}
            </div>

            <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
                <h3 style="color: #2d3748; margin-bottom: 20px; font-size: 1.3rem;">üóÇÔ∏è Champs du document</h3>
                {% if biFields is defined and biFields is not empty %}
                    <div style="max-height: 320px; overflow-y: auto; border: 1px solid #e2e8f0; border-radius: 8px;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="background: #f7fafc;">
                                    <th style="text-align: left; padding: 12px; border-bottom: 1px solid #e2e8f0; width: 35%;">Nom du champ</th>
                                    <th style="text-align: left; padding: 12px; border-bottom: 1px solid #e2e8f0;">Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for field in biFields %}
                                    <tr>
                                        <td style="padding: 10px 12px; border-bottom: 1px solid #edf2f7; font-family: monospace; color: #2d3748;">
                                            {{ field.ICVAR_NOM ?? '-' }}
                                        </td>
                                        <td style="padding: 10px 12px; border-bottom: 1px solid #edf2f7; color: #4a5568; white-space: pre-wrap;">
                                            {{ field.ICVAR_LIB ?? '-' }}
                                        </td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                {% else %}
                    <div class="alert alert-info">Aucun champ associ√© trouv√© pour ce document.</div>
                {% endif %}
            </div>
        </div>
    </div>

    <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
        <h3 style="color: #2d3748; margin-bottom: 20px; font-size: 1.3rem;">‚ö° Actions</h3>
        <div style="display: flex; gap: 15px; flex-wrap: wrap;">
            <a href="{{ path('admin_edition_bureautique_download', {'id': entity.NOM_BI}) }}" class="btn btn-primary">
                üì• T√©l√©charger le mod√®le
            </a>
            <a href="{{ path('admin_edition_bureautique_query', {'id': entity.NOM_BI}) }}" class="btn btn-info">
                üîç Voir la requ√™te SQL
            </a>
        </div>
        <div style="margin-top: 15px; padding: 15px; background: #f7fafc; border-radius: 8px; border-left: 4px solid #4299e1;">
            <p style="color: #2d3748; margin: 0; font-size: 0.9rem;">
                <strong>üìÅ Emplacement du mod√®le :</strong> \\172.22.0.34\Conteneur\OPULISE\bureautique\{{ entity.NOM_DOCUMENT ?? entity.NOM_BI }}
            </p>
        </div>
    </div>
{% endblock %} 